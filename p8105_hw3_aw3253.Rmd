---
title: HOMEWORK 3
author: "aw3253"
output: github_document
---

Preparing to load and tidy data:
```{r, message=FALSE}
library(tidyverse)
```




## Problem 1
```{r}
library(p8105.datasets)
data("instacart")

instacart
```

This data set has 15 variables collected from 1,384,617 products ordered on instacart.Some key variables are the product name, and where this product is located like the aisle,aisle_id, and department name. We also get some important information about the user that describes days since the last order to see how often a user orders from instacart or if they are a first-time user. For example, while user_id #112108 placed their last order 9 days ago, user_id #167740 placed their last order 2 days ago. 


```{r aisles info}
      
uniq_aisles = distinct(instacart, aisle_id)

aisle_count <- instacart %>%
  group_by(aisle_id) %>%
  summarize(n = n()) %>%
  arrange(desc(aisle_id))
```

There are 134 aisles, and it seems that the aisle most ordered from is aisle
83, fresh vegetables.



```{r aisle plot}

which_aisles = 
  instacart %>%
  group_by(aisle_id) %>%
  summarize(n = n()) %>%
  filter(n > 100000)

which_aisles

  ggplot(which_aisles, aes(x = aisle_id)) + 
  geom_histogram()+
   ggtitle("Figure 3: Number of orders in Aisles 24 and 83")


```

Aisles are ordered from least to greatest on the histogram, and only 2 aisles, fresh fruits and fresh vegetables had over 10,000 orders. 

```{r}

pop_data =
  instacart%>% 
  filter(aisle %in% c("baking ingredients", "dog food care", "packaged vegetables fruits")) %>% 
  group_by(aisle, product_name) %>% 
  summarize(n = n()) %>% 
  filter(n == max(n))

pop_data
```

Light brown sugar is ordered the most in baking ingredients (499 orders), Snack Sticks Chicken & Rice Recipe Dog Treats is he popular product in the dog care aisle (30 orders), and organic baby spinach is the most popular i the packed vegetable fruits aisle (9784 orders).


```{r}

sweets = 
instacart %>% 
  filter(product_name %in% c("Pink Lady Apples", "Coffee Ice Cream")) %>% 
  group_by(product_name, order_dow) %>% 
  summarize(avg_hour = mean(order_hour_of_day))
  
sweets_final=
  pivot_wider(
    sweets, 
    names_from = "product_name", 
    values_from = "avg_hour")

sweets_final

```

On average, orders for Pink Lady Apples and Coffee Ice Cream are made between the 11th to 14th hour of the day.
